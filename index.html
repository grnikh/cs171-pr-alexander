<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Alexander: The What If? of History</title>

    <!-- ADD Libraries-->
    <script src="libs/d3/d3.min.js" charset="utf-8"></script>
    <script src="libs/topojson/topojson.v1.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="libs/jquery/jquery-2.1.1.min.js" charset="utf-8"></script>
    <script src="libs/bootstrap/js/bootstrap.min.js" charset="utf-8"></script>
    <script src="libs/jquery-ui/jquery-ui.js"></script>

    <!--Stylesheets-->
    <link rel="stylesheet" type="text/css" href="libs/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/jquery.range.css">
    <link rel="stylesheet" type="text/css" href="libs/jquery-ui/jquery-ui.css">

    <!-- Get some nice font-->
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>

    <!-- add own vis classes-->
    <script src = "js/mapvis.js"></script>
    <script src = "js/mapvis2.js"></script>
    <script src = "js/barvis.js"></script>
    <script src = "js/pictvis.js"></script>
    <script src = "js/pictvis2.js"></script>
    <script src = "js/linevis.js"></script>

    <!-- add own stylesheet-->
    <link rel="stylesheet" type="text/css" href="css/myStyle.css">
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Alexander and the <i>Gymnosophist</i></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#viz1">The War to End All Wars</a></li>
            <li><a href="#viz3">Militarization</a></li>
            <li><a href="#viz2">Progress</a></li>
            <li><a href="#viz4">Losses of War</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/raahilsha/cs171-pr-alexander/">Github</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="row">
        <svg height="20"></svg>
    </div>
    <div class="container">
        <div class="jumbotron" id="jumbo1">
              <h1>Alexander and the <i>Gymnosophist</i></h1>
              <div style="width: 50%; margin: 0 auto; text-align: center"><h2>60 Years of Peace</h2></div>
              <img src="alexander_circled.png" alt="Alexander" height="200" width="200"><img align="right" src="gymnosophist_circled.png" alt="Gymnosophist" height="200" width="200">
              <p>“It took place, once, in 326 B.C. on the banks of a river called the Indus, now in Pakistan… Alexander, a young Macedonian, met there what he called a "gymnosophist," which means "the naked, wise man." We don't know who he was... Alexander asked, "What are you doing?" and the gymnosophist answered, "I'm experiencing nothingness." Then the gymnosophist asked, "What are you doing?" and Alexander said, "I am conquering the world." And they both laughed. Each one thought that the other was a fool. The gymnosophist said, "Why is he conquering the world? It's pointless."</p>
              <p><a href="http://www.ted.com/talks/devdutt_pattanaik/transcript?language=en#t-204000">Devdutt Pattanaik</a></p>
              <div><iframe width="1025" height="500" src="https://www.youtube.com/embed/vcCB3n6wdDI" frameborder="0" align="center" allowfullscreen></iframe></div>
                <div class="row">
                    <svg height="50"></svg>
                </div>


              <div style="width: 25%; margin: 0 auto;"><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a class="btn btn-success btn-lg" href="#viz1">&nbsp&nbsp&nbsp&nbsp&#x25bc&nbsp&nbsp&nbsp&nbsp</a></p></div>
        </div>

        <a name="viz1"></a>
        <div class="row"><svg height="0"></svg></div>
        <div class="page-header">
            <div class="row">
                <div class="col-lg-12">
                  <h1 id="buttons">The War to End All Wars?</h1>
                </div>
            </div>
        </div>
        <p>World War II ended in 1946. Many, including US president Woodrow Wilson, hoped that this would be the last war that humanity would have to face. Let's see if this was actually the case. Press "Play" to step through history year by year. Hover over any feature to examine it in detail.</p>

        <div class="row">
            <div class="col-md-1"><p id="timeRow" style="position: relative; top: 75%; transform: translateY(-25%); font-size: 18px">Year:</p></div>
            <div class="col-md-10" id="timeSlider"></div>
            <button onclick="playMapVis()" type="submit" class="btn btn-success">Play</button>
        </div>
        <div class="row">
            <svg height="20"></svg>
        </div>
        <div class="row">
            <div class="col-md-6" id="mapVis">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <p>Power Index: Part of the world's material capabilities accumulated in a particular country at the given time. It is calculated based on total and urban population, military expenditure and personal, iron and steel production and primary energy consumption. <a href="http://www.correlatesofwar.org/data-sets/national-material-capabilities">(Details Here)</a></p>
            </div>
            <div class="col-md-6">
                <p style="text-align: right">In the visualization above, countries engaged in warfare are highlighted in red. If there is a line connecting a country to another, it indicates that the two are at war. A country that is highlighted in red but with no line is undergoing some form of internal conflict. Starting 1989, data is present to allow one to identify individual battles on a global scale, represented by red circles.</p>
            </div>
        </div>

        <div class="row">
            <svg height="10"></svg>
        </div>
        <div style="width: 25%; margin: 0 auto;"><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a class="btn btn-success btn-lg" href="#viz3">&nbsp&nbsp&nbsp&nbsp&#x25bc&nbsp&nbsp&nbsp&nbsp</a></p></div>

        <a name="viz3"></a>
        <div class="row"><svg height="0"></svg></div>
        <div class="page-header">
            <div class="row">
                <div class="col-lg-12">
                  <h1 id="buttons">Resources Wasted on War</h1>
                </div>
            </div>
        </div>

        <p>Since World War II, the proportion and volume of resources that the societies of the world spend on warfare has not declined, despite efforts by peacekeeping organizations to decrease it. The charts below contain information on the amount of resources countries use towards their military.</p>

        <div class="row">
            <div class="col-md-12" id="topVis">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12" id="midVis">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12" id="botVis">
            </div>
        </div>
        <div class="row">
            <svg height="10"></svg>
        </div>
        <div class="row">
            <div class="col-md-6">
            </div>
            <div class="col-md-6">
                <p style="text-align: right">* This is considered by some to be an important measure of a country's military development. (<a href="http://www.correlatesofwar.org/data-sets/national-material-capabilities">[1]</a>)</p>
            </div>
        </div>
        <div style="width: 25%; margin: 0 auto;"><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a class="btn btn-success btn-lg" href="#viz2">&nbsp&nbsp&nbsp&nbsp&#x25bc&nbsp&nbsp&nbsp&nbsp</a></p></div>


        <a name="viz2"></a>
        <div class="row"><svg height="0"></svg></div>
        <div class="page-header">
            <div class="row">
                <div class="col-lg-12">
                  <h1 id="buttons">Progress</h1>
                </div>
            </div>
        </div>
        <p>Although war never truly ended in 1946 following WW2, some progress has been made regarding world peace. Let us explore international agreements that have been made since 1946. Press "Play" to step through history year by year. Hover over any feature to examine it in detail.</p>
        <div class="row">
            <div class="col-md-1"><p id="timeRow2" style="position: relative; top: 75%; transform: translateY(-25%); font-size: 18px">Year:</p></div>
            <div class="col-md-10" id="timeSlider2"></div>
            <button onclick="playMapVis2()" type="submit" class="btn btn-success">Play</button>
        </div>
        <div class="row">
            <svg height="20"></svg>
        </div>
        <div class="row">
            <div class="col-md-6" id="mapVis2">
            </div>
        </div>
        <div class="row">
            <svg height="10"></svg>
        </div>
        <div style="width: 25%; margin: 0 auto;"><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a class="btn btn-success btn-lg" href="#viz4">&nbsp&nbsp&nbsp&nbsp&#x25bc&nbsp&nbsp&nbsp&nbsp</a></p></div>

        <a name="viz4"></a>
        <div class="row"><svg height="0"></svg></div>
        <div class="page-header">
            <div class="row">
                <div class="col-lg-12">
                  <h1 id="buttons">The Losses of War</h1>
                </div>
            </div>
        </div>
        <p>But what if World War II were actually the world's last war? Below is a pictogram showing how many lives could have been saved and much money could have been used for better causes. For example, malaria nets could have been distributed 900 times over to everyone in danger of malaria with all the money spent in military expenditures after World War II. (<a href="http://www.givewell.org/international/top-charities/AMF">[2]</a>)</p>
        <div class="row">
            <div class="col-md-2"><p id="timeRow4" style="position: relative; top: 75%; transform: translateY(-25%); font-size: 18px">Year:</p></div>
            <div class="col-md-9" id="timeSlider4"></div>
        </div>
        <div class="row">
            <div class="col-md-12" id="pictVis">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12" id="pictVis2">
            </div>
        </div>
        
        <div class="row"><svg height="0"></svg></div>
        <div class="page-header">
            <div class="row">
                <div class="col-lg-12">
                  <h1 id="buttons">Credits</h1>
                </div>
            </div>
        </div>
        Grigory Khimulya - <a href="">Link</a>
    </div>
    <script>
    	// Instantiate the slider
        $("#timeSlider").slider({
            range: "min",
            max: 2007,
            min: 1946,
            orientation: "horizontal",
            value: 1946,
            animate: "fast",
            step: 1,
            change: function(d, i) {updateYear()},
            slide: function(d, i) {updateYear()}
        });
        $("#timeSlider2").slider({
            range: "min",
            max: 2007,
            min: 1946,
            orientation: "horizontal",
            value: 1946,
            animate: "fast",
            step: 1,
            change: function(d, i) {updateYear2()},
            slide: function(d, i) {updateYear2()}
        });
        $("#timeSlider4").slider({
            range: "min",
            max: 2007,
            min: 1946,
            orientation: "horizontal",
            values: [1946, 2007],
            range: true,
            animate: "fast",
            step: 1,
            change: function(d, i) {updateYear4()},
            slide: function(d, i) {updateYear4()}
        });

        // Set jumbotron to page height
        $(document).ready(function(){
           // $('#jumbo1').height($(window).height());
            $('#jumbo2').height($(window).height());
            $('#jumbo3').height($(window).height());
            $('#jumbo4').height($(window).height());
        });

        // variables keeping global knowledge of the data
        var countries_map;
        var power_ranks;
        var blips_data;
        var deaths_data;
        var at_war;
        var lat_long;
        var allies;
        var mil_ex;
        var miltot;
        var milgdp;

        var map_vis;
        var map_vis2;
        var bar_vis;
        var pict_vis;
        var pict_vis2;
        var lineTopVis;
        var lineMidVis;
        var lineBotVis;

        function updateYear()
        {
            map_vis.wrangleData($("#timeSlider").slider("value"));
            d3.select("#timeRow").text("Yr: " + $("#timeSlider").slider("value"));
        }

        function updateYear2()
        {
            d3.select("#timeRow2").text("Yr: " + $("#timeSlider2").slider("value"));
            map_vis2.wrangleData($("#timeSlider2").slider("value"));
        }

        function updateYear4()
        {
            d3.select("#timeRow4").text("Years: " + $("#timeSlider4").slider("values", 0) + " - " + $("#timeSlider4").slider("values", 1));
            pict_vis.wrangleData($("#timeSlider4").slider("values", 0), $("#timeSlider4").slider("values", 1));
            pict_vis2.wrangleData($("#timeSlider4").slider("values", 0), $("#timeSlider4").slider("values", 1));
        }

        function playMapVis()
        {
            $("#timeSlider").slider("value", 1946);
            playRecursive(2007 - 1946);
        }

        function playMapVis2()
        {
            $("#timeSlider2").slider("value", 1946);
            playRecursive2(2007 - 1946);
        }

        function playRecursive(x)
        {
            if (x <= 0)
            {
                $("#timeSlider").slider("option", "disabled", false);
                return;
            }
            $("#timeSlider").slider("option", "disabled", true);
            $("#timeSlider").slider("value", $("#timeSlider").slider("value") + 1);
            setTimeout(function() {playRecursive(x - 1);}, 1000);
        }

        function playRecursive2(x)
        {
            if (x <= 0)
            {
                $("#timeSlider2").slider("option", "disabled", false);
                return;
            }
            $("#timeSlider2").slider("option", "disabled", true);
            $("#timeSlider2").slider("value", $("#timeSlider2").slider("value") + 1);
            setTimeout(function() {playRecursive2(x - 1);}, 1000);
        }

        $(function()
        {

            var initVis = function()
            {
                var MyEventHandler = new Object();

                map_vis = new MapVis(d3.select("#mapVis"), countries_map, power_ranks, blips_data, at_war, lat_long, MyEventHandler);
                map_vis.updateVis();
                map_vis2 = new MapVis2(d3.select("#mapVis2"), countries_map, power_ranks, blips_data, at_war, lat_long, allies, MyEventHandler);
                map_vis2.updateVis();
                pict_vis = new PictVis(d3.select("#pictVis"), deaths_data, mil_ex, MyEventHandler);
                pict_vis.updateVis();
                pict_vis2 = new PictVis2(d3.select("#pictVis2"), deaths_data, mil_ex, MyEventHandler);
                pict_vis2.updateVis();

                lineTopVis = new LineVis(d3.select("#topVis"), miltot, 0.1, 1, lat_long, MyEventHandler);
                lineMidVis = new LineVis(d3.select("#midVis"), milgdp, 0.4, 2, lat_long, MyEventHandler);
                lineBotVis = new LineVis(d3.select("#botVis"), milirs, 1.55, 3, lat_long, MyEventHandler);

                // bar_vis = new BarVis(d3.select("#barVis"), power_ranks, MyEventHandler)
                updateYear();
                updateYear2();
                updateYear4();

                $(MyEventHandler).bind("countryChanged", function(event, argument)
                {
                    lineTopVis.onSelectionChange(argument);
                    lineMidVis.onSelectionChange(argument);
                    lineBotVis.onSelectionChange(argument);
                });
            }

            // call this function after both files are loaded -- error should be "null" if no error
            var dataLoaded = function (error, _world, _powerrank, _blips, _deaths, _atwar, _milex, _latlong, _miltot, _alliances, _milex_gdp, _irst)
            {
                if (!error)
                {
                    countries_map = topojson.feature(_world, _world.objects.countries).features;
                    power_ranks = _powerrank;
                    blips_data = _blips;
                    deaths_data = _deaths;
                    at_war = _atwar;
                    lat_long = _latlong;
                    allies = _alliances;
                    mil_ex = _milex;

                    miltot = _miltot;
                    milgdp = _milex_gdp;
                    milirs = _irst;

                    console.log(milirs);

                    initVis();
                }
                else
                {
                    console.log("Error Loading Data");
                    console.log(error);
                }
            }

            var startHere = function()
            {
                queue()
                    .defer(d3.json, 'data/world-topo-min.json')
                    .defer(d3.json, 'data/power-rank.json')
                    .defer(d3.json, 'data/blips.json')
                    .defer(d3.json, 'data/deaths.json')
                    .defer(d3.json, 'data/at_war.json')
                    .defer(d3.json, 'data/milex.json')
                    .defer(d3.json, 'data/latlong.json')
                    .defer(d3.json, 'data/mil-total.json')
                    .defer(d3.json, 'data/alliances.json')
                    .defer(d3.json, 'data/milex-gdp.json')
                    .defer(d3.json, 'data/irst-capita.json')
                    .await(dataLoaded);
            }

            startHere();
        })
    </script>
</body>
</html>
